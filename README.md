## Консольное приложение: Справочник сотрудников (Python + SQLite)

Консольное приложение, реализующее 6 режимов работы согласно заданию. Реализация на Python с использованием SQLite (только стандартная библиотека).

Все текстовые файлы в UTF-8.

### Возможности
- Создание таблицы сотрудников с полями: Фамилия, Имя, Отчество (опционально), Дата рождения, Пол.
- Добавление одной записи через параметры командной строки.
- Вывод всех строк с уникальным значением ФИО+Дата рождения, отсортированных по ФИО, с расчётом полного возраста (лет).
- Генерация и пакетная вставка 1 000 000 случайных сотрудников (+100 сотрудников Male с фамилией, начинающейся на «F»).
- Выполнение и замер времени запроса: пол — Male, Фамилия начинается с «F».
- Оптимизация базы (индексы) и повторный замер времени до/после.

### Технологии
- Python 3.10+
- SQLite (`sqlite3` из стандартной библиотеки)
- ООП: классы `DBManager`, `Employee`

### Структура проекта
```
Task_2/
  main.py
  src/
    __init__.py
    db.py        # DBManager: подключение, DDL, вставка, выборки, индексы
    models.py    # Employee: расчёт возраста, сохранение, пакетная вставка
    utils.py     # Генераторы данных для режима 4
  data/
    employees.sqlite  # создаётся при первом запуске
```

### Установка
- Требуется Python 3.10+.
- Внешние зависимости отсутствуют.
- Рекомендуется виртуальное окружение.

Windows PowerShell:
```
cd "C:\Users\amiri\PycharmProjects\Task_2"
python --version
# при необходимости:
# py --version
```

### Запуск (Режимы CLI)
- 1) Создание таблицы:
```
python main.py 1
```

- 2) Вставка одной записи:
```
python main.py 2 "Ivanov Petr Sergeevich" 2009-07-12 Male
```

- 3) Вывод уникальных по ФИО+ДР, отсортированных по ФИО; вывод возраста:
```
python main.py 3
```

- 4) Генерация 1 000 000 записей (+100 Male с фамилией на 'F') и пакетная вставка:
```
python main.py 4
```
Примечание: операция займёт время и место на диске.

- 5) Замер времени запроса: пол=Male и фамилия начинается с 'F':
```
python main.py 5
```
Пример вывода:
```
Query returned 12345 rows in 78.12 ms
```
Это время используйте в отчёте.

- 6) Оптимизация (индексы) + повторный замер:
```
python main.py 6
```
Пример вывода:
```
Baseline: 12345 rows in 78.12 ms
Optimized: 12345 rows in 12.34 ms
Improvement: 65.78 ms faster
```
В отчёт добавьте времена до и после.

### Модель данных
Таблица: `employees`
- `id` INTEGER PRIMARY KEY AUTOINCREMENT
- `last_name` TEXT NOT NULL
- `first_name` TEXT NOT NULL
- `middle_name` TEXT NULL
- `birth_date` DATE NOT NULL (YYYY-MM-DD)
- `gender` TEXT NOT NULL ("Male" | "Female")

Индексы:
- `idx_employees_name (last_name, first_name, middle_name)` — для сортировки в режиме 3.
- `idx_employees_gender_lastname (gender, last_name)` — для фильтрации в режимах 5/6.

### Примечания по реализации
- Возраст считается в полных годах от текущей даты до `birth_date`.
- Уникальность в режиме 3 достигается по `(last_name, first_name, middle_name, birth_date)` через CTE.
- Пакетная вставка (режим 4) выполняется транзакцией с `executemany` и ослабленными PRAGMA-параметрами для ускорения.

### Устранение неполадок
- Для “чистого” старта удалите файл БД `data\employees.sqlite`.
- Если команда `python` не найдена, используйте `py`.
- Если в режиме 3 раньше возникала ошибка преобразования даты — обновитесь до текущей версии (дата из БД парсится из ISO-строки).

### Лицензия
MIT



